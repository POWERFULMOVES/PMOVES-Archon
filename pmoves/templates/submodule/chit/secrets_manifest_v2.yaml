# PMOVES.AI CHIT Secrets Manifest Template
# Place at: chit/secrets_manifest_v2.yaml or .chit/secrets_manifest_v2.yaml
# Copy this template to your new service directory and customize for your service

# Version 2.0
api_version: "2.0"

environment: ${CHIT_ENVIRONMENT:-production}

# Secrets sources in precedence order (higher number = higher precedence)
sources:
  # 1. Environment variables (base precedence - 50)
  # 2. CHIT Vault (overrides env vars - highest precedence 100)
  # 3. Docker secrets (for development - precedence 75)
  # 4. Git crypt (fallback - lowest precedence - 0)

# =============================================================================
# Service Identity (REQUIRED)
# =============================================================================
service_slug: "your-service-slug"
name: "Your Service Name"
version: "1.0.0"
description: "Description of your service for PMOVES.AI dashboard and documentation"

# Ports exposed by this service
ports:
  - name: main
    port: 8080
    protocol: http
  - name: metrics
    port: 9090
    protocol: http

# =============================================================================
# Service Secrets
# =============================================================================

# === Environment Variables (base precedence: 50) ===
# Define your service-specific environment variables here
# Format: SERVICE_NAME_VARIABLE_NAME
# These are loaded from env.shared automatically

# === Example: API Key ===
# - name: YOUR_SERVICE_API_KEY
#   description: "API key for external service access"
#   required: true
#   category: credentials
#   source: env
#   default_value: ""  # Empty default means required but can be optional

# === Example: Database URL ===
# - name: YOUR_SERVICE_DATABASE_URL
#   description: "Connection string for your database"
#   required: true
#   category: credentials
#   source: env
#   default_value: ""

# === Example: NATS Connection ===
# - name: NATS_URL
#   description: "NATS message bus connection URL"
#   required: true
#   category: credentials
#   source: env
#   default_value: "nats://nats:4222"

# === Example: Optional: LLM Provider ===
# - name: YOUR_SERVICE_LLM_PROVIDER
#   description: "Default LLM provider for AI features"
#   required: false
#   category: configuration
#   source: env
#   default_value: "tensorzero"  # or "openrouter", "anthropic", etc.

# =============================================================================
# CHIT Vault Secrets (precedence 100 - overrides env vars)
# =============================================================================
# Add CHIT vault specific secrets here
# These override environment variables with higher precedence

# === Service API Key (example) ===
# - name: YOUR_SERVICE_API_KEY
#   chit_vault:
#     path: secrets/your-service/api_key
#     required: true
#     description: "API key for external service authentication"
#     category: credentials
#     template: "your-api-key-here"

# === Example: Database Password (example) ===
# - name: YOUR_SERVICE_DB_PASSWORD
#   chit_vault:
#     path: secrets/your-service/db_password
#     required: true
#     description: "Database password"
#     category: credentials
#     template: "your-db-password-here"

# =============================================================================
# Docker Secrets (precedence 75 - for development)
# =============================================================================
# Add docker_secrets for development-specific credentials
# These are loaded from /run/secrets/ in containers

# === Example: S3 Credentials ===
# - name: YOUR_SERVICE_S3_ACCESS_KEY
#   docker_secret:
#     path: /run/secrets/your_service_s3_access_key
#     required: true
#     description: "S3-compatible storage access key"
#     category: credentials

# =============================================================================
# Git Crypt Secrets (precedence 0 - lowest precedence, fallback)
# =============================================================================
# Add git_crypt secrets as fallback for secrets not in CHIT Vault
# These should be used for development when CHIT Vault is unavailable

# === Example: Git Crypt Secret ===
# - name: YOUR_SERVICE_GIT_CRYPT_KEY
#   git_crypt:
#     path: secrets/your-service/git_crypt_key
#     required: false
#     description: "Fallback encryption key for development"
#     category: credentials
#     template: "your-git-crypt-key-here"

# =============================================================================
# Service Registration (for service discovery)
# =============================================================================
# Add your service to pmoves registry for automatic discovery

# === Service Groups ===
groups:
  - name: tier
    services:
      - your-service-slug
    description: "Your Service"
    tier: "worker"  # or "llm" or "data" or "api" or "media" or "agent"

# =============================================================================
# Validation Rules (optional)
# =============================================================================
validation:
  strict: false  # Set to true to fail on validation errors
  fail_on_missing_required: true  # Set to false if testing locally

# NATS External Configuration
# This configuration enables NATS for external mesh access via TLS
#
# This file is used when NATS_EXTERNAL_URL is set to expose NATS
# outside the Docker network for multi-host service discovery.

# Listen on all interfaces for external connections
host: "0.0.0.0"
port: 4222

# TLS Configuration (when enabled)
# TLS certificates should be generated using: make nats-tls-setup
tls {
    cert_file: "/etc/nats/tls/server.crt"
    key_file: "/etc/nats/tls/server.key"
    ca_file: "/etc/nats/tls/ca.crt"
    verify: true
    verify_and_map: true
}

# Authorization for external connections
authorization {
    # Default user for internal services
    default_user: pmoves

    # Users for external mesh nodes
    # External nodes should use username:pmoves password:mesh_password
    user: pmoves {
        password: "pmoves"  # Should be overridden by environment
        permissions: $ADMIN

        # Permissions for publish/subscribe
        publish: ">"
        subscribe: ">"
    }
}

# JetStream configuration for persistence
jetstream {
    # Store directory for JetStream data
    store_dir: "/data/jetstream"

    # Memory storage
    max_memory: 1GB

    # File storage
    max_file_store: 10GB
}

# Monitoring
monitoring {
    # Enable monitoring
    enable: true

    # Port for monitoring HTTP endpoint
    port: 8222
}

# Logging
log_file: "/dev/stdout"
logtime: true
debug: false
trace: false
